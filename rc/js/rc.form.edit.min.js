rc=rc||{},rc.ui=rc.ui||{},rc.modal=rc.modal||{},rc.initializeFormAppInDesignMode=function(){console.log("rc.initializeFormAppInDesignMode"),rc.comp.initialize(".modal"),rc.comp.initialize(".page-header"),$("#rc-container-list").sortable({placeholder:"rc-state-highlight well",handle:".rc-container-handle"}),$("#rc-component-overview--attach-image").on("change",function(){var a=new FileReader,b=$("#rc-component-overview--attach-image");b.removeAttr("data-image-data"),this.files&&this.files[0]&&(a.onloadend=function(a){b.attr("data-image-data",a.target.result)},a.readAsDataURL(this.files[0]))}),rc.selectFormInfoList(),$("#rc-page-container").find('.page-header [data-value="'+rc.getParam("mode")+'"]').click(),rc.events.on("view-change",rc.comp.HtmlBlock.refreshView),rc.events.on("view-change",rc.rollupPlaceholderValues),rc.events.on("view-change",rc.rollupDefaultValues),rc.initializeModals(),rc.initializeHeaderButtons()},rc.selectFormInfoList=function(a,b){return a=a||new jQuery.Deferred,b=b||{},b.__action=rc.actions.selectFormInfoList,rc.comp.remoting.send(a,b,rc.selectFormInfoList.done,rc.selectFormInfoList.fail),a.promise()},rc.selectFormInfoList.done=function(a,b,c){var e=$("#rc-form-name-list");e.find(".rc-form-name").remove(),e.siblings().find(".dropdown-toggle-text").html("&nbsp;");var f=$('[data-dropdown-menu="form-list"]');f.empty(),f.siblings().find(".dropdown-toggle-text").html("&nbsp;");var g=e.find(".divider");$(c).each(function(a,b){var c=$('<li class="rc-form-name"><a class="rc-cursor-pointer rc-cascade-value rc-toggle-active rc-cascade-dropdown-text rc-link"></a></li>');c.find("a").attr("data-cascade","data-page"),c.find("a").attr("data-value",b.id),c.find("a").text(b.name),g.before(c);var d=c.clone();d.find("a").attr("data-cascade","data-value"),f.append(d)}),rc.comp.initialize(e),rc.comp.initialize(f),e.find(".rc-link").on("click",rc.selectFormData);var h=rc.getParamVal("form");null!=h&&""!=h?$('.rc-link[data-value="'+h+'"]').click():$(".rc-link:first").click(),a&&a.resolve&&a.resolve()},rc.selectFormInfoList.fail=function(a,b,c,d){console.error("rc.selectFormInfoList.fail"),console.error("this",this),console.error("send",b),console.error("recv",c),console.error("meta",d)},rc.selectFormData=function(){var a=rc.getParamVal("form");(null==a||""==a)&&(a=$(this).attr("data-value"),rc.setParam("form",a));var b="#{base}/"+rc.ns+"campaign_designform?id=#{cid}&form=#{fid}";b=b.replace("#{base}","//"+rc.siteUrl),b=b.replace("#{cid}",rc.campaignId),b=b.replace("#{fid}",a),$(".page-header a.fa-link").attr("href",b),rc.remoting.invokeAction(rc.actions.selectFormData,rc.campaignId,a,rc.selectFormData.done,{escape:!1}),rc.ui.markProcessing()},rc.selectFormData.done=function(a){a=a||{},a.containers=a.containers||[],a.workflows=a.workflows||[],a.data=a.data||{},rc.comp.importContentCSS($("html"),a.styles),rc.comp.updateContentCSS($("html")),rc.validationsEnabled=a.data["validations-enabled"]||"false",$("#validations-enabled").prop("checked","true"==rc.validationsEnabled).bootstrapToggle("true"==rc.validationsEnabled?"on":"off"),a.data["theme-href"]&&a.data["theme-name"]?($("#rc-theme-link").attr("href",a.data["theme-href"]),$("#rc-theme-link").attr("data-name",a.data["theme-name"])):$("#rc-theme-menu").find('[data-value=""]').click(),rc.reInitProductSlots(),$("#rc-container-list").empty(),$("#rc-workflows-list").empty();var b=$("#rc-component-workflow-action--workflow").find(".dropdown-menu");b.empty(),$(a.workflows).each(function(a,c){try{var d=$('<a class="rc-cascade-dropdown-text rc-cursor-pointer rc-cascade-value"></a>');d.attr("data-cascade","data-value"),d.attr("data-value",c.data.guid),d.text(rc.text(c.data.name)),b.append(d.wrap("<li></li>").parent())}catch(e){console.error("[ERROR]",e)}}),$(a.workflows).each(function(a,b){rc.comp.insertWorkflow("#rc-workflows-list",b)}),$(a.containers).each(function(a,b){rc.comp.insertColumnList("#rc-container-list",b)}),$(".dropdown-menu[data-original-target]").each(function(){var a=$(this).attr("data-original-target");$(this).find('.rc-cascade-value[data-value="'+a+'"]').click()}),$("#rc-container-list").is(":empty")?$("#rc-container-list-messages").slideDown():$("#rc-container-list-messages").slideUp(),rc.ui.markProcessingDone(),$("#rc-ui-icon-unsaved-changes").hide(),rc.rollupDefaultValues(),rc.selectData()},rc.rollupPlaceholderValues=function(){var c=$("[placeholder]");c.length&&$(c).each(function(a,b){b=$(b);var c=b.attr("placeholder")||"";(0==b.val()||""==b.val())&&b.val(c)})},rc.setModeView=function(){var a=rc.setParam("mode","view");return rc.events.trigger("view-change",!1),a},rc.setModeEdit=function(){var a=rc.setParam("mode","edit");return rc.events.trigger("view-change",!0),a},rc.setModeFlow=function(){var a=rc.setParam("mode","flow");return rc.events.trigger("view-change",!1),a},rc.initializeModals=function(){$("#rc-modal-confirm-clone").find('[data-action="confirm"]').on("click",rc.modal.confirmClone),$("#rc-modal-confirm-delete").find('[data-action="confirm"]').on("click",rc.modal.confirmDelete),$("#rc-modal-confirm-delete-form").find('[data-action="confirm"]').on("click",rc.modal.confirmDeleteForm),$("#rc-modal-confirm-insert-form").find('[data-action="confirm"]').on("click",rc.modal.confirmInsertForm),$("#rc-modal-confirm-rename-form").find('[data-action="confirm"]').on("click",rc.modal.confirmRenameForm),$("#rc-modal-edit-columns").on("show.bs.modal",rc.modal.loadContainerColumns),$("#rc-modal-edit-columns").find('[data-action="save"]').on("click",rc.modal.saveContainerColumns),$("#rc-modal-edit-css").on("show.bs.modal",rc.modal.loadContainerCSS),$("#rc-modal-edit-css").find('[data-action="save"]').on("click",rc.modal.saveContainerCSS),$("#rc-modal-insert-component").on("show.bs.modal",rc.modal.loadInsertComponent),$("#rc-modal-insert-component").find('[data-action="save"]').on("click",rc.modal.saveInsertComponent),$("#rc-modal-help-wizard").on("show.bs.modal",rc.modal.loadHelpWizard),$("#rc-modal-help-wizard").find('[data-action="prev"]').on("click",rc.modal.prevHelpWizard),$("#rc-modal-help-wizard").find('[data-action="next"]').on("click",rc.modal.nextHelpWizard),$("#rc-modal-help-wizard").find('[data-action="undo"]').on("click",function(){$("#rc-modal-help-wizard").find("iframe[src]").attr("src","")}),$("#rc-modal-help-wizard").find(".modal-header .btn[data-value]").on("click",function(){var a=$(this).closest(".modal"),b=$(this).attr("data-value"),c=a.find('.modal-body[data-step="'+b+'"]');a.find("iframe").attr("src",c.attr("data-video-source")),a.find(".modal-body").hide(),c.show()})},rc.initializeHeaderButtons=function(){$("#rc-page-container").find('.page-header [data-value="view"]').on("click",rc.ui.toggleContentEditable),$("#rc-page-container").find('.page-header [data-value="view"]').on("click",rc.setModeView),$("#rc-page-container").find('.page-header [data-value="edit"]').on("click",rc.ui.toggleContentEditable),$("#rc-page-container").find('.page-header [data-value="edit"]').on("click",rc.setModeEdit),$("#rc-page-container").find('.page-header [data-value="flow"]').on("click",rc.ui.toggleContentEditable),$("#rc-page-container").find('.page-header [data-value="flow"]').on("click",rc.setModeFlow),$("#rc-page-container").find('.page-header [data-action="rc-action-save"]').on("click",function(){rc.upsertFormData()}),$("#rc-page-container").find('.page-header [data-action="rc-action-insert-section"]').on("click",function(){var a={data:{columns:$(this).attr("data-value")}};rc.comp.insertColumnList("#rc-container-list",a),rc.ui.markUnsavedChanges()}),$("#rc-page-container").find('.page-header [data-action="rc-action-insert-workflow"]').on("click",function(){rc.comp.insertWorkflow("#rc-workflows-list",{}),rc.ui.markUnsavedChanges()}),$("#rc-theme-menu").find("a").on("click",function(){var a="//netdna.bootstrapcdn.com/bootswatch/3.0.2/#[href]/bootstrap.min.css",b=($(this).attr("data-value")||"").toLowerCase();$("#rc-theme-link").attr("href",a.replace("#[href]",b)),$("#rc-theme-link").attr("data-name",b)})},rc.validateGivingPaymentFields=function(){var a=void 0!=$(".rc-component-merge-field-content").find('[name="'+rc.ns+'giving_giving_frequency__c"]').val()?!0:!1,b=void 0!=$(".rc-component-merge-field-content").find('[name="'+rc.ns+'giving_giving_amount__c"]').val()?!0:!1;return 1==a&&0==b?void rc.ui.showMessagePopup(rc.ui.ERROR,"The Giving Amount field is not on the form. Please add and retry saving the form"):0==a&&1==b?void rc.ui.showMessagePopup(rc.ui.ERROR,"The Giving frequency field is not on the form. Please add and retry saving the form"):void 0},rc.selectFieldInfoList=function(){rc.remoting.invokeAction(rc.actions.selectFieldInfoList,rc.selectFieldInfoList.done),rc.ui.markProcessing()},rc.selectFieldInfoList.done=function(a){var b=$("#rc-modal-insert-component--merge-field-list");b.empty(),$(a).each(function(){var a=$('<a class="list-group-item rc-toggle-active"></a>');a.attr("data-api-name",this.Name),a.attr("data-api-type",""),a.attr("data-loaded","false"),b.append(a)}),rc.ui.markProcessingDone(),rc.selectFieldInfo()},rc.selectFieldInfo=function(){var a=$("#rc-modal-insert-component--merge-field-list"),b=[];a.find('.list-group-item[data-loaded="false"]').each(function(){b.length<50&&b.push({Name:$(this).attr("data-api-name")})}),b.length>0&&(rc.remoting.invokeAction(rc.actions.selectFieldInfo,b,rc.selectFieldInfo.done),rc.ui.markProcessing())},rc.selectFieldInfo.done=function(a){var b=$("#rc-modal-insert-component--merge-field-list");$(a).each(function(){var a=b.find('[data-api-name="'+this.Name+'"]');a.attr("data-api-type",this.Type),a.attr("data-text",this.Label),a.attr("data-local-name",this.LocalName),a.attr("data-loaded","true"),a.text(this.Label),a.attr("data-filter-text",this.Name+"?"+this.Label),a.on("click",rc.toggleMergeFieldSelected)}),rc.ui.markProcessingDone(),rc.selectFieldInfo()},rc.toggleMergeFieldSelected=function(){var a=$(this),b=a.closest(".rc-component-overview");b.find('.form-control[data-cascade="data-merge-field-text"]').val(a.attr("data-text")),b.find('.form-control[data-cascade="data-merge-field-api-name"]').val(a.attr("data-api-name")),b.find('.form-control[data-cascade="data-merge-field-api-type"]').val(a.attr("data-api-type")),a.closest(".dropdown-menu").hide()},rc.deleteFormData=function(){$('.page-header [data-action="rc-action-save"]').button("deleting"),$('.page-header [data-action="rc-action-save"]').addClass("btn-danger"),rc.remoting.invokeAction(rc.actions.deleteFormData,rc.campaignId,rc.getParam("form"),rc.deleteFormData.done),rc.ui.markProcessing()},rc.deleteFormData.done=function(){$('.page-header [data-action="rc-action-save"]').button("save"),$('.page-header [data-action="rc-action-save"]').removeClass("btn-danger"),rc.ui.markProcessingDone({modified:!1}),rc.setParam("form",null),rc.selectFormInfoList()},rc.ui.toggleContentEditable=function(){var a="edit"==$(this).attr("data-value");$("#rc-container-list").find("[contenteditable]").attr("contenteditable",a),rc.events.trigger("view-change",a)},rc.ui.markUnsavedChanges=function(){$("#rc-ui-icon-unsaved-changes").show()},rc.modal.loadContainerCSS=function(){var a=$(".rc-selected").filter(":first"),b=$(this).find(".rc-cascade-value-target");b.find('[data-cascade^="css-"]').filter(".btn-primary").removeClass("btn-primary"),b.find('[data-cascade^="css-"]').filter("input").val(""),b.find('[data-cascade^="css-font-size"]').filter(":first").click(),b.find('[data-cascade^="css-orientation"]').filter(":first").click(),b.find('[data-cascade^="css-text-align"]').filter(":first").click(),$(b.get(0).attributes).each(function(a,c){c.name.match("css-")&&b.removeAttr(c.name)}),$(a.get(0).attributes).each(function(a,c){if(null!=c.name.match("css-")){var d=b.find('[data-cascade^="'+c.name+'"]');d.filter("input,textarea").val(c.value).change(),d.filter('[data-value="'+c.value+'"]').click()}})},rc.modal.saveContainerCSS=function(){var a=$(".rc-selected").filter(":first"),b=$(this).closest(".rc-cascade-value-target");$(a.get(0).attributes).each(function(b,c){c.name.match("css-")&&a.removeAttr(c.name)}),$(b.get(0).attributes).each(function(b,c){if(c.name.match("css-")&&a.attr(c.name,c.value),c.name.match("css-")&&"css-display"==c.name){var d=a.find(".rc-component-content");if(1==d.hasClass("rc-always-hidden-in-view"))return!0;"hidden"==c.value?d.attr("data-field-hidden",!0):d.attr("data-field-hidden",!1)}}),rc.comp.updateContentCSS(a),$(this).closest(".modal").modal("hide"),$(".rc-selected").removeClass("rc-selected"),rc.ui.markUnsavedChanges()},rc.modal.loadContainerColumns=function(){var a=$(".rc-selected").filter(":first"),b=$(this);b.find('.modal-header .btn[data-value="'+a.attr("data-columns")+'"]').click(),a.find(".rc-container-column").each(function(){var a=$(this).attr("data-size")||"12",c=$(this).attr("data-position")||"1",d=b.find('.rc-cp[data-position="'+c+'"]');d.find('.rc-ui-column-width-dropdown-menu [data-value="'+a+'"]:first a').click()})},rc.modal.saveContainerColumns=function(){var a=$(this).closest(".modal"),b=$(".rc-selected").filter(":first"),c=b.find(".rc-container-column-list-content"),d={};d.columns=[],d.data={},d.data.columns=parseInt(a.attr("data-columns")),a.find(".rc-cp").filter(":visible").each(function(){var a={};a.components=[],a.data={},a.data.position=parseInt($(this).attr("data-position")),a.data.size=parseInt($(this).attr("data-size")),d.columns.push(a)}),b.attr("data-columns",d.data.columns),rc.comp.deleteColumnListColumns(c,d.data.columns),rc.comp.upsertColumnListColumns(c,d.data.columns,d.columns),$(this).closest(".modal").modal("hide"),rc.ui.markUnsavedChanges()},rc.modal.loadInsertComponent=function(){var a=$(this);a.find(".rc-toggle-primary.btn-primary").removeClass("btn-primary"),a.find(".rc-toggle-active.active").removeClass("active"),a.find(".rc-component-dropdown .dropdown-toggle-text").html("&nbsp;"),a.find(".rc-component-overview").hide(),a.find('.rc-component-overview[data-component="--none--"]').show(),a.find(".rc-component-overview input").val(""),a.find('.rc-component-overview input[type="checkbox"]').removeAttr("checked"),a.find('.rc-component-overview input[type="radio"]').removeAttr("selected"),a.find(".rc-component-overview textarea").val("");var b=a.find('button[data-cascade="data-position"]');b.filter(":first").addClass("btn-primary"),b.filter(":first").addClass("active"),b.filter(":first").addClass("active").click(),b.show();var c=parseInt($(".rc-selected").filter(":first").attr("data-columns")||"1");b.each(function(){c<=parseInt($(this).attr("data-value"))&&$(this).hide()}),$("#rc-modal-insert-component--merge-field-list").is(":empty")&&rc.selectFieldInfoList()},rc.modal.saveInsertComponent=function(){var a=$(this).closest(".rc-cascade-value-target"),b=a.attr("data-component"),c=a.find('.rc-component-overview[data-component="'+b+'"]'),d=a.attr("data-position"),e=$('.rc-selected:first .rc-container-column[data-position="'+d+'"]'),f=e.find(".rc-container-column-content"),g={};g.type=b,g.data={},"button"==g.type&&(g.data.text=c.find(".form-control").val()),"internal-javascript"==g.type&&(g.data.text=c.find(".form-control").val()),"external-javascript"==g.type&&(g.data.text=c.find(".form-control").val()),"external-stylesheet"==g.type&&(g.data.text=c.find(".form-control").val()),"html-block"==g.type&&(g.data.text=c.find(".form-control").val(),g.data.text=rc.stripTags(g.data.text,"script")),"url-link"==g.type&&(g.data.label=c.find(".form-control.rc-url-label").val(),g.data.link=c.find(".form-control.rc-url-link").val()),"image"==g.type&&("host"==c.find(".btn-primary").attr("data-value")&&(g.data.data=c.find(".form-control.rc-image-host").val()),"file-inline"==c.find(".btn-primary").attr("data-value")&&(g.data.data=c.find(".form-control.rc-image-file").attr("data-image-data"))),"jumbotron"==g.type&&(g.data.header=c.find(".form-control.rc-header").val(),g.data.text=c.find(".form-control.rc-text").val()),"merge-field"==g.type&&(g.data["default"]=c.find('[data-cascade="data-merge-field-default"]').val(),g.data.hidden=c.find('[data-cascade="data-merge-field-hidden"]').val(),g.data.name=c.find('[data-cascade="data-merge-field-api-name"]').val(),g.data.text=c.find('[data-cascade="data-merge-field-text"]').val(),g.data.type=c.find('[data-cascade="data-merge-field-api-type"]').val()),"simple-header"==g.type&&(g.data.text=c.find(".form-control").val()),"simple-text"==g.type&&(g.data.text=c.find(".form-control").val()),"cart"==g.type&&(g.data.header=c.find(".form-control.rc-header").val()),"session"==g.type&&(g.data.header=c.find(".form-control.rc-header").val()),"attribute"==g.type&&(g.data.header=c.find(".form-control.rc-header").val()),rc.comp.upsertComponent(f,g),$(this).closest(".modal").modal("hide"),rc.ui.markUnsavedChanges()},rc.modal.loadHelpWizard=function(){var a=$(this),b=a.find(".modal-dialog").attr("data-step")||"1";a.find('.modal-header .btn[data-value="'+b+'"]').click()},rc.modal.prevHelpWizard=function(){var a=$(this).closest(".modal");a.find(".modal-header .btn-primary").prev().click()},rc.modal.nextHelpWizard=function(){var a=$(this).closest(".modal");a.find(".modal-header .btn-primary").next().click()},rc.modal.confirmClone=function(){var a=$(".rc-selected"),b=a.clone();a.after(b),rc.comp.initialize(b),$(this).closest(".modal").modal("hide"),$(".rc-selected").removeClass("rc-selected"),rc.ui.markUnsavedChanges()},rc.modal.confirmDelete=function(){rc.updateProductSlots($(".rc-selected")),$(".rc-selected").remove(),$(this).closest(".modal").modal("hide"),$("#rc-container-list").is(":empty")&&$("#rc-container-list-messages").slideDown(),$(".rc-selected").removeClass("rc-selected"),rc.ui.markUnsavedChanges()},rc.modal.confirmDeleteForm=function(){$("#rc-container-list").empty(),$("#rc-workflows-list").empty(),rc.deleteFormData(),$(this).closest(".modal").modal("hide"),rc.ui.markUnsavedChanges()},rc.modal.confirmRenameForm=function(){var a=$(this).closest(".modal");rc.upsertFormData({name:a.find('.modal-body input[type="text"]').val()}),rc.selectFormInfoList(),$(this).closest(".modal").modal("hide")},rc.modal.confirmInsertForm=function(){var a=$(this).closest(".modal");$("#rc-container-list").empty(),$("#rc-workflows-list").empty(),rc.upsertFormData({name:a.find('.modal-body input[type="text"]').val(),type:"insert"}),rc.selectFormInfoList(),$(this).closest(".modal").modal("hide")},rc.upsertFormData=function(a,b){return rc.validateGivingPaymentFields(),a=a||{},a.name=a.name||$("#rc-form-name-list").siblings().find(".dropdown-toggle-text").text(),a.type=a.type||"update",a.form={name:a.name,containers:[],workflows:[],json_version:"0.2",data:{},styles:{}},b=b||new jQuery.Deferred,a.form.data["theme-name"]=$("#rc-theme-link").attr("data-name"),a.form.data["theme-href"]=$("#rc-theme-link").attr("href"),a.form.data["validations-enabled"]=$("#validations-enabled").is(":checked")?"true":"false",$($("html").get(0).attributes).each(function(b,c){if(c.name.match("css-")){var d=c.name.replace("css-","");a.form.styles[d]=c.value}}),$("#rc-container-list").find(".rc-container-column-list").each(function(){rc.upsertFormData.exportFormContainer(a.form.containers,this)}),$("#rc-workflows-list").find(".rc-container-workflow").each(function(){rc.upsertFormData.exportFormWorkflow(a.form.workflows,this)}),0!=$(".input-group.has-error,.form-group.has-error").length?void $('.page-header [data-action="rc-action-save"]').button("error").removeClass("btn-success").addClass("btn-danger"):($('.page-header [data-action="rc-action-save"]').button("saving").removeClass("btn-danger").addClass("btn-success"),"insert"==a.type&&(rc.remoting.invokeAction(rc.actions.upsertFormData,rc.campaignId,null,a.form,function(c,d){rc.upsertFormData.done(b,a,c,d)}),rc.ui.markProcessing()),"update"==a.type&&(rc.remoting.invokeAction(rc.actions.upsertFormData,rc.campaignId,rc.getParam("form"),a.form,function(c,d){rc.upsertFormData.done(b,a,c,d)}),rc.ui.markProcessing()),b.promise())},rc.upsertFormData.done=function(a,b,c,d){console.log("rc.upsertFormData.done"),console.log("deferred",a),console.log("send",b),console.log("recv",c),console.log("meta",d),c=c||{},$('.page-header [data-action="rc-action-save"]').button("save"),rc.ui.markProcessingDone({modified:!1}),rc.getParam("form")!=c.id?(rc.setParam("form",c.id),rc.selectFormInfoList()):rc.selectFormData(),a&&a.resolve&&a.resolve()},rc.upsertFormData.exportFormContainer=function(a,b){var a=a||[],b=$(b),c={};c.columns=[],c.data={},c.data.columns=parseInt(b.attr("data-columns")),c.data.guid=b.attr("id")||rc.guid(),c.styles={},$(b.get(0).attributes).each(function(a,b){if(b.name.match("css-")){var d=b.name.replace("css-","");c.styles[d]=b.value}}),b.find(".rc-container-column").each(function(){rc.upsertFormData.exportFormColumn(c.columns,this)}),a.push(c)},rc.upsertFormData.exportFormColumn=function(a,b){var a=a||[],b=$(b),c={};c.components=[],c.data={},c.data.position=parseInt(b.attr("data-position")),c.data.size=parseInt(b.attr("data-size")),b.find(".rc-component").each(function(){rc.upsertFormData.exportFormComponent(c.components,this)}),a.push(c)},rc.upsertFormData.exportFormComponent=function(a,b){var a=a||[],b=$(b),c={};if(c.styles={},c.type=b.attr("data-component-type"),c.data={},c.data.guid=b.attr("id")||rc.guid(),c.data.customHidden=b.find(".rc-component-content").attr("data-field-hidden"),c.defaultValues={},c.placeholderValues={},"advanced-css"==c.type&&(c.data.text=b.find("textarea").val()),"address"==c.type&&$($(b).find("[data-field-name]")).each(function(){var a="req-"+$(this).attr("data-field-name"),d=$(this).find("[data-required]").attr("data-required");c.data[a]=d,$($(b).find(".rc-field-name")).each(function(){rc.upsertFormData.exportformDefaultValues(c.defaultValues,$(this)),rc.upsertFormData.exportFormPlaceholderValues(c.placeholderValues,$(this))})}),"button"==c.type&&(c.data.text=b.find(".rc-component-content .rc-name").text().trim(),c.data.workflow=b.attr("data-workflow")),"credit-card"==c.type){var d=$(b);d.find('[data-field-hidden="true"]').each(function(a,b){var d=$(b).find(".form-control"),e=d.attr("name");if(!e||""==e)return!0;var f="";"text"==d.attr("type")?f=d.val():"checkbox"==d.attr("type")&&(f=d.is(":checked")?"true":"false"),c.data[e]=f}),$($(b).find("[data-field-name]")).each(function(){$($(b).find(".rc-field-name")).each(function(){rc.upsertFormData.exportformDefaultValues(c.defaultValues,$(this)),rc.upsertFormData.exportFormPlaceholderValues(c.placeholderValues,$(this))})})}"external-stylesheet"==c.type&&(c.data.text=b.find(".rc-component-content .form-control").val()),"external-javascript"==c.type&&(c.data.text=b.find(".rc-component-content .form-control").val()),"internal-javascript"==c.type&&(c.data.text=b.find(".rc-component-content .form-control").val()),"image"==c.type&&(c.data.data=b.find("img").attr("src")),"jumbotron"==c.type&&(c.data.header=b.find(".rc-header").text(),c.data.text=b.find(".rc-text").text()),"merge-field"==c.type&&(c.data["default"]=b.find(".rc-field-name").attr("data-field-default"),c.data.hidden=b.attr("data-hidden"),c.data.name=b.find(".rc-field-name").attr("name"),c.data.required="true"==b.find(".input-group").attr("data-required"),c.data.text=b.find(".rc-field-text").text(),c.data.type=b.attr("data-type"),rc.upsertFormData.exportformDefaultValues(c.defaultValues,$(b.find(".rc-field-name"))),rc.upsertFormData.exportFormPlaceholderValues(c.placeholderValues,$(b.find(".rc-field-name")))),"simple-header"==c.type&&(c.data.text=b.find(".rc-component-content").text()),"simple-text"==c.type&&(c.data.text=b.find(".rc-component-content").text()),"html-block"==c.type&&(c.data.text=$.data(b.find(".rc-component-html-content .rc-value")[0],"html-content"),-1!=c.data.text.indexOf("<script")?(rc.ui.addMessageToComponent(b,"The script tag is not allowed in HTML block. Please remove it to save your change.",rc.ui.WARNING),$(b).find(".form-group").addClass("has-error")):$(b).find(".form-group").removeClass("has-error")),"url-link"==c.type&&(c.data.label=b.find(".rc-url-label input.form-control").val(),c.data.link=b.find(".rc-url-link input.form-control").val()),"campaign-ask"==c.type&&(c.data.required="true"==b.find(".input-group").attr("data-required"),c.data["text-1"]=b.find(".text-1").text(),c.data["text-2"]=b.find(".text-2").text(),"false"==c.data.required&&b.find(".input-group").hide()),"cart"==c.type&&(c.data.header=b.find(".cart-header-text").text(),c.data.required="true"==b.find(".input-group").attr("data-required"),c.data=rc.comp.Cart.populateSetupSaveData(b,c.data)),"session"==c.type&&(c.data.header=b.find(".session-header-text").text(),c.data.required="true"==b.find(".input-group").attr("data-required"),c.data=rc.comp.Session.populateSetupSaveData(b,c.data)),"attribute"==c.type&&(c.data.attribute_id=b.find(".attribute-select").val(),c.data.productSlot=b.find(".rc-field-name").attr("name"),c.data.required="true"==b.find(".input-group").attr("data-required"));var e=rc.validate.populateUpsertFormData(b);c=$.extend(c,e),$(b.get(0).attributes).each(function(a,b){if(b.name.match("css-")){var d=b.name.replace("css-","");c.styles[d]=b.value}}),a.push(c)},rc.upsertFormData.exportFormWorkflow=function(a,b){var a=a||[],b=$(b),c={};c.actions=[],c.data={},c.data.guid=b.attr("id")||rc.guid(),c.data.name=b.find(".rc-workflow-name").val(),c.data.active=b.find(".rc-workflow-active").is(":checked"),b.find(".rc-component").each(function(){rc.upsertFormData.exportFormWorkflowAction(c.actions,this)}),a.push(c)},rc.upsertFormData.exportFormWorkflowAction=function(a,b){var a=a||[],b=$(b),c={};if(c.context=b.attr("data-context")||"then",c.method=b.attr("data-method")||"",c.data={},c.data.guid=b.attr("id")||rc.guid(),"send-mail"==c.method)c.data["mail-to"]=b.attr("data-mail-to"),c.data["mail-reply-to"]=b.attr("data-mail-reply-to"),c.data["mail-subject"]=b.attr("data-mail-subject"),c.data["mail-body"]=b.attr("data-mail-body");else if("send-payment"==c.method&&"corduro"==b.attr("data-value"))c.data.data=b.attr("data-value"),c.data["auth-token"]=b.attr("data-auth-token"),c.data["auth-only"]=b.attr("data-auth-only"),c.data["test-only"]=b.attr("data-test-only");else if("send-payment"==c.method&&"iATS"==b.attr("data-value"))c.data.data=b.attr("data-value");else if("send-payment"==c.method&&"Litle"==b.attr("data-value")){c.data.data=b.attr("data-value"),c.data["advanced-fraud-detection"]=b.attr("data-advanced-fraud-detection");var d=b.attr("data-advanced-fraud-detection-test-mode");c.data["advanced-fraud-detection-test-mode"]=d,c.data.sessionId="true"==d?b.attr("data-sessionId"):""}else"send-payment"==c.method&&"Authorize.net"==b.attr("data-value")?c.data.data=b.attr("data-value"):"send-payment"==c.method&&"Cybersource"==b.attr("data-value")?c.data.data=b.attr("data-value"):"copy-param"==c.method?(c.data.data=b.attr("data-value"),c.data.parameter=b.attr("data-parameter")):"send-data"==c.method?(c.data["exclude-giving"]=b.attr("exclude-giving"),c.data["exclude-events"]=b.attr("exclude-events"),c.data.data=b.attr("data-value")):c.data.data=b.attr("data-value");a.push(c)},rc.upsertFormData.exportformDefaultValues=function(a,b){a=a||{},b=$(b);var c=b.attr("name")||"";return a[c]=b.attr("data-field-default")||"",!0},rc.upsertFormData.exportFormPlaceholderValues=function(a,b){a=a||{},b=$(b)||"";var c=b.attr("name")||"";return a[c]=b.attr("placeholder")||"",!0},rc.initializeFormAppInDesignMode();
